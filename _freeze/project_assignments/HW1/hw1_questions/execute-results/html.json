{
  "hash": "e9988348a828b88e228fc14613abd6d1",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"A Replication of Karlan and List (2007)\"\nauthor: \"Dominic Schenone\"\ndate: today\ncallout-appearance: minimal # this hides the blue \"i\" icon on .callout-notes\n---\n\n\n## Introduction\n\nDean Karlan at Yale and John List at the University of Chicago conducted a field experiment to test the effectiveness of different fundraising letters. They sent out 50,000 fundraising letters to potential donors, randomly assigning each letter to one of three treatments: a standard letter, a matching grant letter, or a challenge grant letter. They published the results of this experiment in the _American Economic Review_ in 2007. The article and supporting data are available from the [AEA website](https://www.aeaweb.org/articles?id=10.1257/aer.97.5.1774) and from Innovations for Poverty Action as part of [Harvard's Dataverse](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/27853&version=4.2).\n\nThis project seeks to replicate the key findings from Karlan and List (2007), explore extensions of their analysis, and reflect on the implications of their design and results. Throughout, I aim to verify treatment effects on donation rates and amounts, assess baseline balance, and explore how match ratios influence giving behavior.\n\n\n## Data\n\n::: {#c289655c .cell execution_count=1}\n``` {.python .cell-code}\n##Importing Pandas and also our data as df \nimport pandas as pd \ndf = pd.read_stata('karlan_list_2007.dta')\n\n##Looking at some of the qualities of the data\n##The Shape\nprint(\"The Shape of our Data: \", df.shape)\nprint(\"The Different DataTypes of our columns\")\n\nprint(\"Info: \", df.info())\nprint(\"First 5 Rows\", df.head())\nprint(\"DataTypes of columns: \", df.dtypes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe Shape of our Data:  (50083, 51)\nThe Different DataTypes of our columns\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 50083 entries, 0 to 50082\nData columns (total 51 columns):\n #   Column              Non-Null Count  Dtype   \n---  ------              --------------  -----   \n 0   treatment           50083 non-null  int8    \n 1   control             50083 non-null  int8    \n 2   ratio               50083 non-null  category\n 3   ratio2              50083 non-null  int8    \n 4   ratio3              50083 non-null  int8    \n 5   size                50083 non-null  category\n 6   size25              50083 non-null  int8    \n 7   size50              50083 non-null  int8    \n 8   size100             50083 non-null  int8    \n 9   sizeno              50083 non-null  int8    \n 10  ask                 50083 non-null  category\n 11  askd1               50083 non-null  int8    \n 12  askd2               50083 non-null  int8    \n 13  askd3               50083 non-null  int8    \n 14  ask1                50083 non-null  int16   \n 15  ask2                50083 non-null  int16   \n 16  ask3                50083 non-null  int16   \n 17  amount              50083 non-null  float32 \n 18  gave                50083 non-null  int8    \n 19  amountchange        50083 non-null  float32 \n 20  hpa                 50083 non-null  float32 \n 21  ltmedmra            50083 non-null  int8    \n 22  freq                50083 non-null  int16   \n 23  years               50082 non-null  float64 \n 24  year5               50083 non-null  int8    \n 25  mrm2                50082 non-null  float64 \n 26  dormant             50083 non-null  int8    \n 27  female              48972 non-null  float64 \n 28  couple              48935 non-null  float64 \n 29  state50one          50083 non-null  int8    \n 30  nonlit              49631 non-null  float64 \n 31  cases               49631 non-null  float64 \n 32  statecnt            50083 non-null  float32 \n 33  stateresponse       50083 non-null  float32 \n 34  stateresponset      50083 non-null  float32 \n 35  stateresponsec      50080 non-null  float32 \n 36  stateresponsetminc  50080 non-null  float32 \n 37  perbush             50048 non-null  float32 \n 38  close25             50048 non-null  float64 \n 39  red0                50048 non-null  float64 \n 40  blue0               50048 non-null  float64 \n 41  redcty              49978 non-null  float64 \n 42  bluecty             49978 non-null  float64 \n 43  pwhite              48217 non-null  float32 \n 44  pblack              48047 non-null  float32 \n 45  page18_39           48217 non-null  float32 \n 46  ave_hh_sz           48221 non-null  float32 \n 47  median_hhincome     48209 non-null  float64 \n 48  powner              48214 non-null  float32 \n 49  psch_atlstba        48215 non-null  float32 \n 50  pop_propurban       48217 non-null  float32 \ndtypes: category(3), float32(16), float64(12), int16(4), int8(16)\nmemory usage: 8.9 MB\nInfo:  None\nFirst 5 Rows    treatment  control    ratio  ratio2  ratio3      size  size25  size50  \\\n0          0        1  Control       0       0   Control       0       0   \n1          0        1  Control       0       0   Control       0       0   \n2          1        0        1       0       0  $100,000       0       0   \n3          1        0        1       0       0  Unstated       0       0   \n4          1        0        1       0       0   $50,000       0       1   \n\n   size100  sizeno  ... redcty  bluecty    pwhite    pblack  page18_39  \\\n0        0       0  ...    0.0      1.0  0.446493  0.527769   0.317591   \n1        0       0  ...    1.0      0.0       NaN       NaN        NaN   \n2        1       0  ...    0.0      1.0  0.935706  0.011948   0.276128   \n3        0       1  ...    1.0      0.0  0.888331  0.010760   0.279412   \n4        0       0  ...    0.0      1.0  0.759014  0.127421   0.442389   \n\n   ave_hh_sz  median_hhincome    powner  psch_atlstba  pop_propurban  \n0       2.10          28517.0  0.499807      0.324528            1.0  \n1        NaN              NaN       NaN           NaN            NaN  \n2       2.48          51175.0  0.721941      0.192668            1.0  \n3       2.65          79269.0  0.920431      0.412142            1.0  \n4       1.85          40908.0  0.416072      0.439965            1.0  \n\n[5 rows x 51 columns]\nDataTypes of columns:  treatment                 int8\ncontrol                   int8\nratio                 category\nratio2                    int8\nratio3                    int8\nsize                  category\nsize25                    int8\nsize50                    int8\nsize100                   int8\nsizeno                    int8\nask                   category\naskd1                     int8\naskd2                     int8\naskd3                     int8\nask1                     int16\nask2                     int16\nask3                     int16\namount                 float32\ngave                      int8\namountchange           float32\nhpa                    float32\nltmedmra                  int8\nfreq                     int16\nyears                  float64\nyear5                     int8\nmrm2                   float64\ndormant                   int8\nfemale                 float64\ncouple                 float64\nstate50one                int8\nnonlit                 float64\ncases                  float64\nstatecnt               float32\nstateresponse          float32\nstateresponset         float32\nstateresponsec         float32\nstateresponsetminc     float32\nperbush                float32\nclose25                float64\nred0                   float64\nblue0                  float64\nredcty                 float64\nbluecty                float64\npwhite                 float32\npblack                 float32\npage18_39              float32\nave_hh_sz              float32\nmedian_hhincome        float64\npowner                 float32\npsch_atlstba           float32\npop_propurban          float32\ndtype: object\n```\n:::\n:::\n\n\n### Description\n\n\n\n:::: {.callout-note collapse=\"true\"}\n### Variable Definitions\n\n| Variable             | Description                                                         |\n|----------------------|---------------------------------------------------------------------|\n| `treatment`          | Treatment                                                           |\n| `control`            | Control                                                             |\n| `ratio`              | Match ratio                                                         |\n| `ratio2`             | 2:1 match ratio                                                     |\n| `ratio3`             | 3:1 match ratio                                                     |\n| `size`               | Match threshold                                                     |\n| `size25`             | \\$25,000 match threshold                                            |\n| `size50`             | \\$50,000 match threshold                                            |\n| `size100`            | \\$100,000 match threshold                                           |\n| `sizeno`             | Unstated match threshold                                            |\n| `ask`                | Suggested donation amount                                           |\n| `askd1`              | Suggested donation was highest previous contribution                |\n| `askd2`              | Suggested donation was 1.25 x highest previous contribution         |\n| `askd3`              | Suggested donation was 1.50 x highest previous contribution         |\n| `ask1`               | Highest previous contribution (for suggestion)                      |\n| `ask2`               | 1.25 x highest previous contribution (for suggestion)               |\n| `ask3`               | 1.50 x highest previous contribution (for suggestion)               |\n| `amount`             | Dollars given                                                       |\n| `gave`               | Gave anything                                                       |\n| `amountchange`       | Change in amount given                                              |\n| `hpa`                | Highest previous contribution                                       |\n| `ltmedmra`           | Small prior donor: last gift was less than median \\$35              |\n| `freq`               | Number of prior donations                                           |\n| `years`              | Number of years since initial donation                              |\n| `year5`              | At least 5 years since initial donation                             |\n| `mrm2`               | Number of months since last donation                                |\n| `dormant`            | Already donated in 2005                                             |\n| `female`             | Female                                                              |\n| `couple`             | Couple                                                              |\n| `state50one`         | State tag: 1 for one observation of each of 50 states; 0 otherwise  |\n| `nonlit`             | Nonlitigation                                                       |\n| `cases`              | Court cases from state in 2004-5 in which organization was involved |\n| `statecnt`           | Percent of sample from state                                        |\n| `stateresponse`      | Proportion of sample from the state who gave                        |\n| `stateresponset`     | Proportion of treated sample from the state who gave                |\n| `stateresponsec`     | Proportion of control sample from the state who gave                |\n| `stateresponsetminc` | stateresponset - stateresponsec                                     |\n| `perbush`            | State vote share for Bush                                           |\n| `close25`            | State vote share for Bush between 47.5% and 52.5%                   |\n| `red0`               | Red state                                                           |\n| `blue0`              | Blue state                                                          |\n| `redcty`             | Red county                                                          |\n| `bluecty`            | Blue county                                                         |\n| `pwhite`             | Proportion white within zip code                                    |\n| `pblack`             | Proportion black within zip code                                    |\n| `page18_39`          | Proportion age 18-39 within zip code                                |\n| `ave_hh_sz`          | Average household size within zip code                              |\n| `median_hhincome`    | Median household income within zip code                             |\n| `powner`             | Proportion house owner within zip code                              |\n| `psch_atlstba`       | Proportion who finished college within zip code                     |\n| `pop_propurban`      | Proportion of population urban within zip code                      |\n\n::::\n\n\n### Balance Test \n\nAs an ad hoc test of the randomization mechanism, I provide a series of tests that compare aspects of the treatment and control groups to assess whether they are statistically significantly different from one another.\n\n::: {#79f27224 .cell execution_count=2}\n``` {.python .cell-code}\n#These are the variables that I am going to include\n#They are not outcome variables, so they will be good to use to test to see if the population distrbutions are significantly different:\n#mrm2 – months since last donation\n#hpa – highest previous amount donated\n#freq – number of prior donations\nfrom scipy.stats import t\nimport numpy as np\n\ndef compute_ci(var, group_var=\"treatment\", conf_level=0.95):\n    a = df[df[group_var] == 1][var].dropna()\n    b = df[df[group_var] == 0][var].dropna()\n\n    x_a, x_b = a.mean(), b.mean()\n    s_a, s_b = a.std(), b.std()\n    n_a, n_b = len(a), len(b)\n\n    diff = x_a - x_b\n    se = np.sqrt((s_a**2 / n_a) + (s_b**2 / n_b))\n    dof = min(n_a, n_b) - 1\n    t_star = t.ppf((1 + conf_level) / 2, df=dof)\n\n    margin = t_star * se\n    lower, upper = diff - margin, diff + margin\n\n    print(f\"{var} | Mean Diff: {diff:.4f} | CI: ({lower:.4f}, {upper:.4f})\")\n\n# Run CI calculations for a few variables\nfor variable in [\"mrm2\", \"hpa\", \"freq\"]:\n    compute_ci(variable)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmrm2 | Mean Diff: 0.0137 | CI: (-0.2107, 0.2381)\nhpa | Mean Diff: 0.6371 | CI: (-0.6498, 1.9239)\nfreq | Mean Diff: -0.0120 | CI: (-0.2238, 0.1998)\n```\n:::\n:::\n\n\n::: {.callout-note}\n### Balance Check Interpretation\n\nTo assess balance across treatment and control groups, I computed 95% confidence intervals for the difference in means on several baseline characteristics. The intervals for `mrm2`, `hpa`, and `freq` all include zero, suggesting that the groups were well-balanced and no statistically significant differences were present. This supports the validity of the random assignment.\n:::\n\n\nNow I will go on to see if the results from making a linear regression, for variable mrm2, will match that from that as the t-test @95% confidence\n\n::: {#6ef77e5f .cell execution_count=3}\n``` {.python .cell-code}\nfrom scipy.stats import t\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\n\n# --- T-Test (using classic formula) ---\na = df[df[\"treatment\"] == 1][\"mrm2\"].dropna()\nb = df[df[\"treatment\"] == 0][\"mrm2\"].dropna()\n\nmean_diff = a.mean() - b.mean()\nse = np.sqrt((a.var(ddof=1)/len(a)) + (b.var(ddof=1)/len(b)))\ndof = min(len(a), len(b)) - 1\nt_stat = mean_diff / se\n\nprint(f\"T-Test result for mrm2:\")\nprint(f\"  Mean difference: {mean_diff:.4f}\")\nprint(f\"  SE: {se:.4f}\")\nprint(f\"  t-stat: {t_stat:.4f}\")\n\n# --- Linear Regression ---\nmodel = smf.ols(\"mrm2 ~ treatment\", data=df).fit()\nprint(\"\\nLinear Regression result for mrm2:\")\nprint(model.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nT-Test result for mrm2:\n  Mean difference: 0.0137\n  SE: 0.1145\n  t-stat: 0.1195\n\nLinear Regression result for mrm2:\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                   mrm2   R-squared:                       0.000\nModel:                            OLS   Adj. R-squared:                 -0.000\nMethod:                 Least Squares   F-statistic:                   0.01428\nDate:                Tue, 06 Jan 2026   Prob (F-statistic):              0.905\nTime:                        20:53:01   Log-Likelihood:            -1.9585e+05\nNo. Observations:               50082   AIC:                         3.917e+05\nDf Residuals:                   50080   BIC:                         3.917e+05\nDf Model:                           1                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nIntercept     12.9981      0.094    138.979      0.000      12.815      13.181\ntreatment      0.0137      0.115      0.119      0.905      -0.211       0.238\n==============================================================================\nOmnibus:                     8031.352   Durbin-Watson:                   2.004\nProb(Omnibus):                  0.000   Jarque-Bera (JB):            12471.135\nSkew:                           1.163   Prob(JB):                         0.00\nKurtosis:                       3.751   Cond. No.                         3.23\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\nTo verify the balance of baseline variable mrm2, I conducted both a two-sample t-test and a linear regression with treatment as the sole predictor. Both approaches yielded nearly identical estimates:\n\nMean difference: 0.0137\n\nStandard error: ~0.115\n\nt-statistic: 0.119\n\nThese consistent results confirm that a linear regression with a binary treatment variable is mathematically equivalent to a t-test. This approach mirrors the analysis used in Table 1 of Karlan and List (2007), which demonstrates the success of randomization in balancing observable characteristics across groups.\n## Experimental Results\n\n### Charitable Contribution Made\n\nFirst, I analyze whether matched donations lead to an increased response rate of making a donation. \n\n::: {#288b0129 .cell execution_count=4}\n``` {.python .cell-code}\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Calculate mean donation rate by group\ndonation_rates = df.groupby(\"treatment\")[\"gave\"].mean().reset_index()\ndonation_rates[\"group\"] = donation_rates[\"treatment\"].map({0: \"Control\", 1: \"Treatment\"})\n\n# Create barplot\nsns.barplot(data=donation_rates, x=\"group\", y=\"gave\")\nplt.title(\"Proportion of People Who Donated\")\nplt.ylabel(\"Proportion Donated\")\nplt.xlabel(\"Group\")\nplt.ylim(0, donation_rates[\"gave\"].max() + 0.01)\nplt.grid(True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-5-output-1.png){width=606 height=449}\n:::\n:::\n\n\n::: {#0b0eb4e0 .cell execution_count=5}\n``` {.python .cell-code}\nfrom scipy.stats import ttest_ind\nimport statsmodels.formula.api as smf\n\n# T-test: donation rates (binary outcome)\ngave_ttest = ttest_ind(df[df[\"treatment\"] == 1][\"gave\"],\n                       df[df[\"treatment\"] == 0][\"gave\"])\nprint(\"T-test result for 'gave' (donation made):\", gave_ttest)\n\n# Bivariate regression: gave ~ treatment\ngave_reg = smf.ols(\"gave ~ treatment\", data=df).fit()\nprint(gave_reg.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nT-test result for 'gave' (donation made): TtestResult(statistic=3.101361000543946, pvalue=0.0019274025949016982, df=50081.0)\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                   gave   R-squared:                       0.000\nModel:                            OLS   Adj. R-squared:                  0.000\nMethod:                 Least Squares   F-statistic:                     9.618\nDate:                Tue, 06 Jan 2026   Prob (F-statistic):            0.00193\nTime:                        20:53:02   Log-Likelihood:                 26630.\nNo. Observations:               50083   AIC:                        -5.326e+04\nDf Residuals:                   50081   BIC:                        -5.324e+04\nDf Model:                           1                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nIntercept      0.0179      0.001     16.225      0.000       0.016       0.020\ntreatment      0.0042      0.001      3.101      0.002       0.002       0.007\n==============================================================================\nOmnibus:                    59814.280   Durbin-Watson:                   2.005\nProb(Omnibus):                  0.000   Jarque-Bera (JB):          4317152.727\nSkew:                           6.740   Prob(JB):                         0.00\nKurtosis:                      46.440   Cond. No.                         3.23\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\nI performed a t-test to compare the donation rates between individuals who received a matching donation offer and those who did not. The test yielded a statistically significant result (p = 0.0019), indicating that those who received the match offer were more likely to donate. While the absolute difference in rates is small (from ~1.8% to ~2.2%), the result is highly unlikely to have occurred by chance. This suggests that even modest behavioral nudges — such as the promise of a matched gift — can influence charitable giving. This supports the idea presented in Table 2a of Karlan and List (2007), where matched donations are shown to increase response rates.\n\n::: {.callout-note}\n### Probit Model Interpretation\n\nI used a probit regression to model the likelihood that a person made a charitable donation as a function of whether they were offered a matching donation. The coefficient on the treatment variable was positive and statistically significant (z = 3.11, p = 0.002), suggesting that individuals who received the matching offer were more likely to donate.\n:::\n\n::: {#aa9b0880 .cell execution_count=6}\n``` {.python .cell-code}\nimport statsmodels.api as sm\n\n# Prepare data for probit\nX = sm.add_constant(df[\"treatment\"])  # Add intercept\ny = df[\"gave\"]\n\n# Fit probit model\nprobit_model = sm.Probit(y, X).fit()\nprint(probit_model.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOptimization terminated successfully.\n         Current function value: 0.100443\n         Iterations 7\n                          Probit Regression Results                           \n==============================================================================\nDep. Variable:                   gave   No. Observations:                50083\nModel:                         Probit   Df Residuals:                    50081\nMethod:                           MLE   Df Model:                            1\nDate:                Tue, 06 Jan 2026   Pseudo R-squ.:               0.0009783\nTime:                        20:53:03   Log-Likelihood:                -5030.5\nconverged:                       True   LL-Null:                       -5035.4\nCovariance Type:            nonrobust   LLR p-value:                  0.001696\n==============================================================================\n                 coef    std err          z      P>|z|      [0.025      0.975]\n------------------------------------------------------------------------------\nconst         -2.1001      0.023    -90.073      0.000      -2.146      -2.054\ntreatment      0.0868      0.028      3.113      0.002       0.032       0.141\n==============================================================================\n```\n:::\n:::\n\n\n::: {.callout-tip}\n### Why Use a Probit Model?\n\nProbit regression is more appropriate for binary outcomes like donation (`gave = 0/1`) than OLS, because it models probabilities between 0 and 1 using the cumulative normal distribution. It’s a standard choice in applied microeconomics and matches the method used by Karlan & List (2007).\n:::\n\nAlthough the raw coefficient from a probit model isn’t directly interpretable as a probability, the significant result aligns with earlier t-tests and linear regression findings. This confirms that the treatment has a measurable effect on donation behavior. In essence, people respond to matching offers — even small nudges like this can meaningfully influence giving.\n\nI also took the liberty of calculating how much more likely someone is to donate because of the treatment, in percentage terms. \n\n::: {#e1d41cdd .cell execution_count=7}\n``` {.python .cell-code}\n# Get marginal effects\nmarginal_effects = probit_model.get_margeff()\nprint(marginal_effects.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Probit Marginal Effects       \n=====================================\nDep. Variable:                   gave\nMethod:                          dydx\nAt:                           overall\n==============================================================================\n                dy/dx    std err          z      P>|z|      [0.025      0.975]\n------------------------------------------------------------------------------\ntreatment      0.0043      0.001      3.104      0.002       0.002       0.007\n==============================================================================\n```\n:::\n:::\n\n\nBeing offered a matching donation increases the probability of giving by approximately 0.43 percentage points (e.g., from 1.8% to ~2.2%). While small, this is statistically significant and meaningful in a high-volume fundraising context.\n\n_NOTE: Linear regression results appear replicate Table 3 column 1 in the paper. Probit results do not, despite Table 3 indicating its results come from probit regressions..._\n\n\n### Differences between Match Rates\n\nNext, I assess the effectiveness of different sizes of matched donations on the response rate.\n\n::: {.callout-note}\n### Match Ratio Interpretation (T-test + Regression)\n\nI conducted a series of t-tests to examine whether higher match ratios (2:1 and 3:1) led to higher donation rates compared to a 1:1 match. None of the comparisons were statistically significant. This aligns with the findings of Karlan and List (2007), who similarly reported that while matched donations increased giving compared to no match, larger match ratios did not consistently lead to higher response rates. This suggests that the presence of a match, rather than its magnitude, may be the primary behavioral driver.\n:::\n\n::: {#e4c96260 .cell execution_count=8}\n``` {.python .cell-code}\nfrom scipy.stats import ttest_ind\n\n# 1:1 vs 2:1\ngave_1to1 = df[df[\"ratio\"] == 1][\"gave\"]\ngave_2to1 = df[df[\"ratio\"] == 2][\"gave\"]\nttest_2vs1 = ttest_ind(gave_2to1, gave_1to1)\nprint(\"2:1 vs 1:1 match rate:\", ttest_2vs1)\n\n# 2:1 vs 3:1\ngave_3to1 = df[df[\"ratio\"] == 3][\"gave\"]\nttest_3vs2 = ttest_ind(gave_3to1, gave_2to1)\nprint(\"3:1 vs 2:1 match rate:\", ttest_3vs2)\n\n# (Optional) 1:1 vs 3:1\nttest_3vs1 = ttest_ind(gave_3to1, gave_1to1)\nprint(\"3:1 vs 1:1 match rate:\", ttest_3vs1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n2:1 vs 1:1 match rate: TtestResult(statistic=0.96504713432247, pvalue=0.33453168549723933, df=22265.0)\n3:1 vs 2:1 match rate: TtestResult(statistic=0.05011583793874515, pvalue=0.9600305283739325, df=22261.0)\n3:1 vs 1:1 match rate: TtestResult(statistic=1.0150255853798622, pvalue=0.3101046637086672, df=22260.0)\n```\n:::\n:::\n\n\n::: {.callout-tip}\n### Why Regression Might Reveal More\n\nThe regression model pools variance and uses all three match groups in one estimation, which can provide slightly more power than isolated pairwise t-tests. It also allows you to assess the pattern of effects together, rather than in fragments.\n:::\n\n::: {#6c266585 .cell execution_count=9}\n``` {.python .cell-code}\n# Create ratio indicators\ndf[\"ratio1\"] = (df[\"ratio\"] == 1).astype(int)\ndf[\"ratio2\"] = (df[\"ratio\"] == 2).astype(int)\ndf[\"ratio3\"] = (df[\"ratio\"] == 3).astype(int)\n\n# Regression using manual indicators (that I just created)\nmanual_reg = smf.ols(\"gave ~ ratio2 + ratio3\", data=df).fit()\nprint(manual_reg.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                   gave   R-squared:                       0.000\nModel:                            OLS   Adj. R-squared:                  0.000\nMethod:                 Least Squares   F-statistic:                     4.117\nDate:                Tue, 06 Jan 2026   Prob (F-statistic):             0.0163\nTime:                        20:53:03   Log-Likelihood:                 26629.\nNo. Observations:               50083   AIC:                        -5.325e+04\nDf Residuals:                   50080   BIC:                        -5.323e+04\nDf Model:                           2                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nIntercept      0.0190      0.001     22.306      0.000       0.017       0.021\nratio2         0.0036      0.002      2.269      0.023       0.000       0.007\nratio3         0.0037      0.002      2.332      0.020       0.001       0.007\n==============================================================================\nOmnibus:                    59815.856   Durbin-Watson:                   2.005\nProb(Omnibus):                  0.000   Jarque-Bera (JB):          4317637.927\nSkew:                           6.741   Prob(JB):                         0.00\nKurtosis:                      46.443   Cond. No.                         3.16\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\nIn this regression, I examined whether the size of the match ratio influenced the likelihood of donating. The model uses the 1:1 match group as the baseline. Both the 2:1 and 3:1 match groups showed small but statistically significant increases in donation rates, around +0.36 to +0.37 percentage points. This contrasts slightly with the t-tests, which did not find significant differences — likely because the regression model uses more degrees of freedom and pools variance more efficiently.\n\nThe results suggest that larger match ratios may have had a small positive impact, though the effect size is modest. This provides slightly more evidence than Karlan and List (2007), who found no consistent effects. However, even in this case, the behavioral change is relatively small, supporting the idea that the presence of a match may matter more than its magnitude.\n\n\n### Size of Charitable Contribution\n\nIn this subsection, I analyze the effect of the size of matched donation on the size of the charitable contribution.\n\nBelow is the T-Test:\n\n::: {#97d36a6a .cell execution_count=10}\n``` {.python .cell-code}\nfrom scipy.stats import ttest_ind\n\n# T-test comparing average donation amount (including 0s)\nt_amount = ttest_ind(df[df[\"treatment\"] == 1][\"amount\"],\n                     df[df[\"treatment\"] == 0][\"amount\"])\nprint(\"T-test on donation amount:\")\nprint(t_amount)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nT-test on donation amount:\nTtestResult(statistic=1.8605020225753781, pvalue=0.06282038947470686, df=50081.0)\n```\n:::\n:::\n\n\nThe results of this indicate:\n\nNow I am running a bivariate linear regression of the donation amount on the treatment status. It shows: \n\n::: {#5d1d9c00 .cell execution_count=11}\n``` {.python .cell-code}\nimport statsmodels.formula.api as smf\n\n# OLS regression of donation amount on treatment\namount_reg = smf.ols(\"amount ~ treatment\", data=df).fit()\nprint(amount_reg.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                 amount   R-squared:                       0.000\nModel:                            OLS   Adj. R-squared:                  0.000\nMethod:                 Least Squares   F-statistic:                     3.461\nDate:                Tue, 06 Jan 2026   Prob (F-statistic):             0.0628\nTime:                        20:53:03   Log-Likelihood:            -1.7946e+05\nNo. Observations:               50083   AIC:                         3.589e+05\nDf Residuals:                   50081   BIC:                         3.589e+05\nDf Model:                           1                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nIntercept      0.8133      0.067     12.063      0.000       0.681       0.945\ntreatment      0.1536      0.083      1.861      0.063      -0.008       0.315\n==============================================================================\nOmnibus:                    96861.113   Durbin-Watson:                   2.008\nProb(Omnibus):                  0.000   Jarque-Bera (JB):        240735713.635\nSkew:                          15.297   Prob(JB):                         0.00\nKurtosis:                     341.269   Cond. No.                         3.23\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {.callout-note}\n### Overall Donation Amount Interpretation\n\nI analyzed whether people in the treatment group gave more money, on average, than those in the control group. Both a t-test and a linear regression yielded nearly identical results: treatment group participants donated about \\$0.15 more, but the difference was not statistically significant (p ≈ 0.063). This suggests that while there may be a small increase in donation amount due to the treatment, the effect is weak and uncertain when including non-donors in the analysis.\n:::\n\n::: {#8fb4f231 .cell execution_count=12}\n``` {.python .cell-code}\nimport statsmodels.formula.api as smf\n\n# Filter to only people who donated\ndonors = df[df[\"amount\"] > 0]\n\n# Run regression on amount given, conditional on donating\ndonation_reg = smf.ols(\"amount ~ treatment\", data=donors).fit()\nprint(donation_reg.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                 amount   R-squared:                       0.000\nModel:                            OLS   Adj. R-squared:                 -0.001\nMethod:                 Least Squares   F-statistic:                    0.3374\nDate:                Tue, 06 Jan 2026   Prob (F-statistic):              0.561\nTime:                        20:53:03   Log-Likelihood:                -5326.8\nNo. Observations:                1034   AIC:                         1.066e+04\nDf Residuals:                    1032   BIC:                         1.067e+04\nDf Model:                           1                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nIntercept     45.5403      2.423     18.792      0.000      40.785      50.296\ntreatment     -1.6684      2.872     -0.581      0.561      -7.305       3.968\n==============================================================================\nOmnibus:                      587.258   Durbin-Watson:                   2.031\nProb(Omnibus):                  0.000   Jarque-Bera (JB):             5623.279\nSkew:                           2.464   Prob(JB):                         0.00\nKurtosis:                      13.307   Cond. No.                         3.49\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {.callout-note}\n### Conditional Donation Amount Interpretation\n\nI restricted the sample to only those who donated and regressed the donation amount on treatment status. The results showed that donors in the treatment group gave, on average, $1.67 less than those in the control group. However, this difference was not statistically significant (p = 0.561). This suggests that while the match offer may have influenced the decision to donate, it did not affect how much was given among those who did donate.\n:::\n::: {.callout-warning}\n\n### Causality Caveat\n\nThis regression is not strictly causal, because it conditions on having donated — which is a post-treatment outcome. That means you're selecting a subset of people whose outcome (donating) may itself have been influenced by the treatment. This could introduce selection bias, so while the analysis is informative, it should be interpreted descriptively rather than causally.\n:::\n\n\n\n::: {.callout-note}\n### Histogram Interpretation\n\nI created histograms of donation amounts among donors in both the treatment and control groups. Both groups show similar distributions, with most donations clustering around $25 to $75. The red line shows the mean donation, which is slightly higher in the control group. These visuals reinforce the regression results — while the treatment may have influenced donation likelihood, it did not lead to higher amounts among those who gave.\n:::\n\n::: {#362eef05 .cell execution_count=13}\n``` {.python .cell-code}\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Filter to donors only\ndonors = df[df[\"amount\"] > 0]\n\n# --- Histogram for Treatment Group ---\nsns.histplot(data=donors[donors[\"treatment\"] == 1], x=\"amount\", bins=30, kde=False)\nplt.axvline(donors[donors[\"treatment\"] == 1][\"amount\"].mean(), color='red', linestyle='--', label=\"Mean\")\nplt.title(\"Donation Amounts – Treatment Group\")\nplt.xlabel(\"Donation Amount\")\nplt.ylabel(\"Count\")\nplt.legend()\nplt.show()\n\n# --- Histogram for Control Group ---\nsns.histplot(data=donors[donors[\"treatment\"] == 0], x=\"amount\", bins=30, kde=False)\nplt.axvline(donors[donors[\"treatment\"] == 0][\"amount\"].mean(), color='red', linestyle='--', label=\"Mean\")\nplt.title(\"Donation Amounts – Control Group\")\nplt.xlabel(\"Donation Amount\")\nplt.ylabel(\"Count\")\nplt.legend()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-14-output-1.png){width=593 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-14-output-2.png){width=585 height=449}\n:::\n:::\n\n\n## Simulation Experiment\n\nAs a reminder of how the t-statistic \"works,\" in this section I use simulation to demonstrate the Law of Large Numbers and the Central Limit Theorem.\n\nSuppose the true distribution of respondents who do not get a charitable donation match is Bernoulli with probability p=0.018 that a donation is made. \n\nFurther suppose that the true distribution of respondents who do get a charitable donation match of any size is Bernoulli with probability p=0.022 that a donation is made.\n\n::: {.callout-note}\n### Law of Large Numbers\n\nTo illustrate the Law of Large Numbers, I simulated differences in donation rates between treatment and control groups and plotted the cumulative average over 10,000 draws. While early sample differences fluctuated substantially, the average steadily approached the true treatment effect of 0.004. This demonstrates how, with large enough samples, the sample average converges to the population mean — providing reassurance about the reliability of randomized experimental estimates.\n:::\n\n::: {#47b35e3b .cell execution_count=14}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(42)\n\n# Simulate donation outcomes (1 = gave, 0 = didn’t give)\ncontrol_draws = np.random.binomial(1, 0.018, 10000)\ntreatment_draws = np.random.binomial(1, 0.022, 10000)\n\n# Calculate the difference in each trial\ndiffs = treatment_draws - control_draws\n\n# Cumulative average of differences\ncum_avg = np.cumsum(diffs) / (np.arange(1, len(diffs)+1))\n\n# Plot the cumulative average\nplt.plot(cum_avg, color='orange')\nplt.axhline(0.004, color='red', linestyle='--', label=\"True Effect (0.004)\")\nplt.title(\"Cumulative Average of Treatment - Control Differences\")\nplt.xlabel(\"Sample Size\")\nplt.ylabel(\"Cumulative Average\")\nplt.legend()\nplt.grid(True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-15-output-1.png){width=597 height=449}\n:::\n:::\n\n\n::: {.callout-note}\n### Central Limit Theorem\n\nI simulated 1000 samples for four different sizes (n = 50, 200, 500, 1000) and plotted the sampling distribution of the mean difference in donation rates. As expected, with increasing sample size, the distributions became more symmetric and concentrated around the true treatment effect. This visualizes the Central Limit Theorem — regardless of the population distribution, the sampling distribution of the mean becomes approximately normal as the sample size grows.\n:::\n\n::: {#272bf167 .cell execution_count=15}\n``` {.python .cell-code}\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nsample_sizes = [50, 200, 500, 1000]\nnp.random.seed(42)\n\nfor n in sample_sizes:\n    sim_means = []\n    for _ in range(1000):\n        control_sample = np.random.binomial(1, 0.018, n)\n        treatment_sample = np.random.binomial(1, 0.022, n)\n        sim_means.append(np.mean(treatment_sample - control_sample))\n\n    # Plot histogram of sampling distribution\n    plt.figure()\n    sns.histplot(sim_means, bins=30)\n    plt.title(f\"Sampling Distribution of Mean Difference (n = {n})\")\n    plt.xlabel(\"Mean Difference\")\n    plt.ylabel(\"Frequency\")\n    plt.grid(True)\n    plt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-16-output-1.png){width=593 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-16-output-2.png){width=593 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-16-output-3.png){width=593 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](hw1_questions_files/figure-html/cell-16-output-4.png){width=595 height=449}\n:::\n:::\n\n\n",
    "supporting": [
      "hw1_questions_files"
    ],
    "filters": [],
    "includes": {}
  }
}