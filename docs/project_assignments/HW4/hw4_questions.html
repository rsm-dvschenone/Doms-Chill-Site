<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.5">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dominic Schenone">
<meta name="dcterms.date" content="2025-06-11">

<title>Key Drivers Analysis ‚Äì Dominic Vincent Schenone</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ff4371ef257df69894857e99c6ad0d06.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-05251472dafb24aa390e51fef53e4371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Dominic Vincent Schenone</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html"> 
<span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#understanding-the-landscape-of-machine-learning" id="toc-understanding-the-landscape-of-machine-learning" class="nav-link active" data-scroll-target="#understanding-the-landscape-of-machine-learning">Understanding the Landscape of Machine Learning</a>
  <ul class="collapse">
  <li><a href="#supervised-learning-learning-from-labels" id="toc-supervised-learning-learning-from-labels" class="nav-link" data-scroll-target="#supervised-learning-learning-from-labels">Supervised Learning: Learning from Labels</a>
  <ul class="collapse">
  <li><a href="#common-applications" id="toc-common-applications" class="nav-link" data-scroll-target="#common-applications">Common Applications</a></li>
  <li><a href="#algorithms" id="toc-algorithms" class="nav-link" data-scroll-target="#algorithms">Algorithms</a></li>
  <li><a href="#challenges" id="toc-challenges" class="nav-link" data-scroll-target="#challenges">Challenges</a></li>
  </ul></li>
  <li><a href="#unsupervised-learning-finding-hidden-patterns" id="toc-unsupervised-learning-finding-hidden-patterns" class="nav-link" data-scroll-target="#unsupervised-learning-finding-hidden-patterns">Unsupervised Learning: Finding Hidden Patterns</a>
  <ul class="collapse">
  <li><a href="#common-applications-1" id="toc-common-applications-1" class="nav-link" data-scroll-target="#common-applications-1">Common Applications</a></li>
  <li><a href="#algorithms-1" id="toc-algorithms-1" class="nav-link" data-scroll-target="#algorithms-1">Algorithms</a></li>
  <li><a href="#challenges-1" id="toc-challenges-1" class="nav-link" data-scroll-target="#challenges-1">Challenges</a></li>
  </ul></li>
  <li><a href="#supervised-vs-unsupervised-key-differences" id="toc-supervised-vs-unsupervised-key-differences" class="nav-link" data-scroll-target="#supervised-vs-unsupervised-key-differences">Supervised vs Unsupervised: Key Differences</a></li>
  <li><a href="#our-use-case-data-driven-insights-across-domains" id="toc-our-use-case-data-driven-insights-across-domains" class="nav-link" data-scroll-target="#our-use-case-data-driven-insights-across-domains">Our Use Case: Data-Driven Insights Across Domains</a>
  <ul class="collapse">
  <li><a href="#palmer-penguins-dataset" id="toc-palmer-penguins-dataset" class="nav-link" data-scroll-target="#palmer-penguins-dataset">üêß 1. <strong>Palmer Penguins Dataset</strong></a></li>
  <li><a href="#brand-key-drivers-dataset" id="toc-brand-key-drivers-dataset" class="nav-link" data-scroll-target="#brand-key-drivers-dataset">üè∑Ô∏è 2. <strong>Brand Key Drivers Dataset</strong></a></li>
  </ul></li>
  <li><a href="#conclusion-what-we-learned-from-the-data" id="toc-conclusion-what-we-learned-from-the-data" class="nav-link" data-scroll-target="#conclusion-what-we-learned-from-the-data">üßæ Conclusion: What We Learned from the Data</a>
  <ul class="collapse">
  <li><a href="#k-means-clustering-unsupervised-learning" id="toc-k-means-clustering-unsupervised-learning" class="nav-link" data-scroll-target="#k-means-clustering-unsupervised-learning">üìä K-Means Clustering (Unsupervised Learning)</a></li>
  <li><a href="#k-nearest-neighbors-supervised-learning" id="toc-k-nearest-neighbors-supervised-learning" class="nav-link" data-scroll-target="#k-nearest-neighbors-supervised-learning">üêß K-Nearest Neighbors (Supervised Learning)</a></li>
  <li><a href="#final-takeaways" id="toc-final-takeaways" class="nav-link" data-scroll-target="#final-takeaways">üí° Final Takeaways</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Key Drivers Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dominic Schenone </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 11, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>This post implements a few measure of variable importance, interpreted as a key drivers analysis, for certain aspects of a payment card on customer satisfaction with that payment card.</p>
<section id="understanding-the-landscape-of-machine-learning" class="level1">
<h1>Understanding the Landscape of Machine Learning</h1>
<p>When diving into machine learning, two primary branches emerge: <strong>supervised</strong> and <strong>unsupervised</strong> learning. Each serves a different purpose and is best suited for particular types of business or research questions.</p>
<blockquote class="blockquote">
<p><strong>Tip</strong> Knowing when to use supervised vs unsupervised learning is crucial. It‚Äôs not just about which algorithm performs best‚Äîit‚Äôs about which type of model is appropriate for the task at hand.</p>
</blockquote>
<hr>
<section id="supervised-learning-learning-from-labels" class="level2">
<h2 class="anchored" data-anchor-id="supervised-learning-learning-from-labels">Supervised Learning: Learning from Labels</h2>
<p>Supervised learning uses <em>labeled data</em>, where the correct outcome is known. The goal is to learn a mapping from inputs (features) to outputs (labels) that can be generalized to predict future outcomes.</p>
<section id="common-applications" class="level3">
<h3 class="anchored" data-anchor-id="common-applications">Common Applications</h3>
<ul>
<li>Predicting <strong>customer churn</strong> (binary classification)</li>
<li>Forecasting <strong>sales or prices</strong> (regression)</li>
<li>Recognizing <strong>objects in images</strong> (multi-class classification)</li>
</ul>
</section>
<section id="algorithms" class="level3">
<h3 class="anchored" data-anchor-id="algorithms">Algorithms</h3>
<ul>
<li>Linear/Logistic Regression</li>
<li>Decision Trees, Random Forests</li>
<li>Support Vector Machines</li>
<li><strong>K-Nearest Neighbors (KNN)</strong> ‚Üê <em>we‚Äôll implement this</em></li>
</ul>
</section>
<section id="challenges" class="level3">
<h3 class="anchored" data-anchor-id="challenges">Challenges</h3>
<ul>
<li>Requires a <strong>well-labeled</strong> dataset</li>
<li>Risk of <strong>overfitting</strong> to training data</li>
<li>Performance is sensitive to irrelevant features or noisy labels</li>
</ul>
<hr>
</section>
</section>
<section id="unsupervised-learning-finding-hidden-patterns" class="level2">
<h2 class="anchored" data-anchor-id="unsupervised-learning-finding-hidden-patterns">Unsupervised Learning: Finding Hidden Patterns</h2>
<p>In contrast, unsupervised learning deals with <strong>unlabeled data</strong>. The algorithm tries to uncover hidden patterns, groupings, or structures from the input alone.</p>
<section id="common-applications-1" class="level3">
<h3 class="anchored" data-anchor-id="common-applications-1">Common Applications</h3>
<ul>
<li><strong>Customer segmentation</strong> in marketing</li>
<li><strong>Anomaly detection</strong> in fraud analytics</li>
<li><strong>Topic modeling</strong> in NLP</li>
</ul>
</section>
<section id="algorithms-1" class="level3">
<h3 class="anchored" data-anchor-id="algorithms-1">Algorithms</h3>
<ul>
<li>K-Means Clustering</li>
<li>Hierarchical Clustering</li>
<li>Principal Component Analysis (PCA)</li>
<li>Latent Class Models</li>
</ul>
</section>
<section id="challenges-1" class="level3">
<h3 class="anchored" data-anchor-id="challenges-1">Challenges</h3>
<ul>
<li>Evaluation is <strong>less straightforward</strong>‚Äîno ground truth</li>
<li>Sensitive to <strong>initialization</strong> and <strong>scaling</strong></li>
<li>Choosing the right number of clusters or components is tricky</li>
</ul>
<hr>
</section>
</section>
<section id="supervised-vs-unsupervised-key-differences" class="level2">
<h2 class="anchored" data-anchor-id="supervised-vs-unsupervised-key-differences">Supervised vs Unsupervised: Key Differences</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 36%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Supervised Learning</th>
<th>Unsupervised Learning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Input Data</td>
<td>Labeled</td>
<td>Unlabeled</td>
</tr>
<tr class="even">
<td>Goal</td>
<td>Predict outcomes</td>
<td>Find structure</td>
</tr>
<tr class="odd">
<td>Evaluation</td>
<td>Metrics like accuracy, RMSE</td>
<td>Subjective, silhouette score, etc.</td>
</tr>
<tr class="even">
<td>Complexity</td>
<td>Depends on model type</td>
<td>Often computationally expensive</td>
</tr>
<tr class="odd">
<td>Common Use Cases</td>
<td>Classification, Regression</td>
<td>Clustering, Dimensionality Reduction</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="our-use-case-data-driven-insights-across-domains" class="level2">
<h2 class="anchored" data-anchor-id="our-use-case-data-driven-insights-across-domains">Our Use Case: Data-Driven Insights Across Domains</h2>
<p>In this assignment, we‚Äôll apply both supervised and unsupervised learning to <strong>two unique datasets</strong>, each offering its own opportunities and challenges.</p>
<section id="palmer-penguins-dataset" class="level3">
<h3 class="anchored" data-anchor-id="palmer-penguins-dataset">üêß 1. <strong>Palmer Penguins Dataset</strong></h3>
<ul>
<li><strong>Purpose:</strong> Supervised learning with K-Nearest Neighbors (KNN)</li>
<li><strong>Task:</strong> Classify penguins by species based on physical characteristics</li>
</ul>
</section>
<section id="brand-key-drivers-dataset" class="level3">
<h3 class="anchored" data-anchor-id="brand-key-drivers-dataset">üè∑Ô∏è 2. <strong>Brand Key Drivers Dataset</strong></h3>
<ul>
<li><strong>Purpose:</strong> Unsupervised learning via K-Means clustering</li>
<li><strong>Task:</strong> Segment respondents by their perceptions of brand characteristics</li>
</ul>
<hr>
<p>In the next sections, we‚Äôll explore how to prepare these datasets and apply machine learning techniques to draw actionable insights. Whether predicting outcomes or discovering hidden structures, machine learning gives us a powerful lens through which to understand the data.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Load and Inspect the Penguin Dataset">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load and Inspect the Penguin Dataset
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-load-penguins" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="op">=</span> pd.read_csv(<span class="st">"palmer_penguins.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>penguins_clean <span class="op">=</span> penguins.dropna()  <span class="co"># Drop missing values</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>penguins_clean.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="load-penguins" class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th">island</th>
<th data-quarto-table-cell-role="th">bill_length_mm</th>
<th data-quarto-table-cell-role="th">bill_depth_mm</th>
<th data-quarto-table-cell-role="th">flipper_length_mm</th>
<th data-quarto-table-cell-role="th">body_mass_g</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>39.1</td>
<td>18.7</td>
<td>181</td>
<td>3750</td>
<td>male</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>39.5</td>
<td>17.4</td>
<td>186</td>
<td>3800</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>40.3</td>
<td>18.0</td>
<td>195</td>
<td>3250</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>36.7</td>
<td>19.3</td>
<td>193</td>
<td>3450</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>39.3</td>
<td>20.6</td>
<td>190</td>
<td>3650</td>
<td>male</td>
<td>2007</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Visualize Feature Relationships by Species">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visualize Feature Relationships by Species
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-pairplot-penguins" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(penguins_clean, hue<span class="op">=</span><span class="st">"species"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">"Pairplot of Penguin Features by Species"</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="pairplot-penguins" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="hw4_questions_files/figure-html/pairplot-penguins-output-1.png" width="1310" height="1227" class="figure-img"></p>
<figcaption>Pairplot of Numeric Features in Penguin Dataset</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout-summary" title="Summary: Penguin Dataset Insights">
<p>The pairplot reveals strong species-level clustering in variables like <code>bill_length_mm</code>, <code>flipper_length_mm</code>, and <code>body_mass_g</code>. These features appear highly informative and will likely support strong performance in classification models such as <strong>K-Nearest Neighbors (KNN)</strong>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Compute Correlations Between Brand Attributes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Compute Correlations Between Brand Attributes
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-load-drivers" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>drivers <span class="op">=</span> pd.read_csv(<span class="st">"data_for_drivers_analysis.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non-feature columns</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>drivers_corr <span class="op">=</span> drivers.drop(columns<span class="op">=</span>[<span class="st">"id"</span>, <span class="st">"brand"</span>]).corr()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>drivers_corr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="load-drivers" class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">satisfaction</th>
<th data-quarto-table-cell-role="th">trust</th>
<th data-quarto-table-cell-role="th">build</th>
<th data-quarto-table-cell-role="th">differs</th>
<th data-quarto-table-cell-role="th">easy</th>
<th data-quarto-table-cell-role="th">appealing</th>
<th data-quarto-table-cell-role="th">rewarding</th>
<th data-quarto-table-cell-role="th">popular</th>
<th data-quarto-table-cell-role="th">service</th>
<th data-quarto-table-cell-role="th">impact</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">satisfaction</td>
<td>1.000000</td>
<td>0.255706</td>
<td>0.191896</td>
<td>0.184801</td>
<td>0.212985</td>
<td>0.207997</td>
<td>0.194561</td>
<td>0.171425</td>
<td>0.251098</td>
<td>0.254539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">trust</td>
<td>0.255706</td>
<td>1.000000</td>
<td>0.399652</td>
<td>0.306493</td>
<td>0.480973</td>
<td>0.420704</td>
<td>0.423868</td>
<td>0.389409</td>
<td>0.503966</td>
<td>0.354062</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">build</td>
<td>0.191896</td>
<td>0.399652</td>
<td>1.000000</td>
<td>0.370705</td>
<td>0.443953</td>
<td>0.369456</td>
<td>0.435770</td>
<td>0.333667</td>
<td>0.407956</td>
<td>0.383639</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">differs</td>
<td>0.184801</td>
<td>0.306493</td>
<td>0.370705</td>
<td>1.000000</td>
<td>0.349693</td>
<td>0.418159</td>
<td>0.349758</td>
<td>0.266456</td>
<td>0.367615</td>
<td>0.416957</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">easy</td>
<td>0.212985</td>
<td>0.480973</td>
<td>0.443953</td>
<td>0.349693</td>
<td>1.000000</td>
<td>0.432904</td>
<td>0.461316</td>
<td>0.387304</td>
<td>0.456976</td>
<td>0.412092</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">appealing</td>
<td>0.207997</td>
<td>0.420704</td>
<td>0.369456</td>
<td>0.418159</td>
<td>0.432904</td>
<td>1.000000</td>
<td>0.481159</td>
<td>0.376080</td>
<td>0.425463</td>
<td>0.394282</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">rewarding</td>
<td>0.194561</td>
<td>0.423868</td>
<td>0.435770</td>
<td>0.349758</td>
<td>0.461316</td>
<td>0.481159</td>
<td>1.000000</td>
<td>0.350825</td>
<td>0.457016</td>
<td>0.384245</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">popular</td>
<td>0.171425</td>
<td>0.389409</td>
<td>0.333667</td>
<td>0.266456</td>
<td>0.387304</td>
<td>0.376080</td>
<td>0.350825</td>
<td>1.000000</td>
<td>0.378262</td>
<td>0.305265</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">service</td>
<td>0.251098</td>
<td>0.503966</td>
<td>0.407956</td>
<td>0.367615</td>
<td>0.456976</td>
<td>0.425463</td>
<td>0.457016</td>
<td>0.378262</td>
<td>1.000000</td>
<td>0.412313</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">impact</td>
<td>0.254539</td>
<td>0.354062</td>
<td>0.383639</td>
<td>0.416957</td>
<td>0.412092</td>
<td>0.394282</td>
<td>0.384245</td>
<td>0.305265</td>
<td>0.412313</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Visualize the Correlation Matrix with a Heatmap">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visualize the Correlation Matrix with a Heatmap
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-heatmap-drivers" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(drivers_corr, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, fmt<span class="op">=</span><span class="st">".2f"</span>, center<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Correlation Matrix: Brand Satisfaction and Attributes"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>plt.show</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="heatmap-drivers" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="hw4_questions_files/figure-html/heatmap-drivers-output-1.png" width="877" height="567" class="figure-img"></p>
<figcaption>Correlation Heatmap of Brand Attributes</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout-summary" title="Summary: Brand Attribute Correlations">
<p>Variables such as <code>trust</code>, <code>appealing</code>, and <code>service</code> exhibit moderate positive correlation with <code>satisfaction</code>. These drivers could be critical in uncovering distinct <strong>consumer segments</strong> via clustering, and in predicting satisfaction using regression-style models.</p>
</div>
<p>üß© Unsupervised Learning: K-Means Clustering on Brand Perceptions To discover hidden customer segments based on brand attribute perceptions, we‚Äôll apply K-Means clustering to the key drivers dataset. This method groups observations into clusters based on similarity, helping marketers understand distinct consumer mindsets.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Scale Features for K-Means Clustering">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Scale Features for K-Means Clustering
</div>
</div>
<div class="callout-body-container callout-body">
<div id="preprocess-drivers" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reload to ensure clean slate</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>drivers <span class="op">=</span> pd.read_csv(<span class="st">"data_for_drivers_analysis.csv"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use only feature columns (drop identifiers)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> drivers.drop(columns<span class="op">=</span>[<span class="st">"id"</span>, <span class="st">"brand"</span>, <span class="st">"satisfaction"</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize features</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Use Elbow Method to Select Number of Clusters">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use Elbow Method to Select Number of Clusters
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-elbow-method" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>inertia <span class="op">=</span> []</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>k_range <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> k_range:</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    kmeans.fit(X_scaled)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    inertia.append(kmeans.inertia_)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>plt.plot(k_range, inertia, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of Clusters (k)'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Inertia'</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Elbow Method for Optimal k'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="elbow-method" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="hw4_questions_files/figure-html/elbow-method-output-1.png" width="661" height="468" class="figure-img"></p>
<figcaption>Elbow Plot for K-Means Clustering</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Fit KMeans with Chosen k (e.g., 3)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fit KMeans with Chosen k (e.g., 3)
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-kmeans-cluster" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>clusters <span class="op">=</span> kmeans.fit_predict(X_scaled)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append cluster labels to original DataFrame</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>drivers[<span class="st">'cluster'</span>] <span class="op">=</span> clusters</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>drivers[[<span class="st">'cluster'</span>] <span class="op">+</span> <span class="bu">list</span>(X.columns)].groupby(<span class="st">"cluster"</span>).mean().<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="kmeans-cluster" class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">trust</th>
<th data-quarto-table-cell-role="th">build</th>
<th data-quarto-table-cell-role="th">differs</th>
<th data-quarto-table-cell-role="th">easy</th>
<th data-quarto-table-cell-role="th">appealing</th>
<th data-quarto-table-cell-role="th">rewarding</th>
<th data-quarto-table-cell-role="th">popular</th>
<th data-quarto-table-cell-role="th">service</th>
<th data-quarto-table-cell-role="th">impact</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.90</td>
<td>0.87</td>
<td>0.80</td>
<td>0.94</td>
<td>0.86</td>
<td>0.85</td>
<td>0.83</td>
<td>0.89</td>
<td>0.84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.15</td>
<td>0.12</td>
<td>0.11</td>
<td>0.12</td>
<td>0.09</td>
<td>0.07</td>
<td>0.19</td>
<td>0.08</td>
<td>0.08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.74</td>
<td>0.51</td>
<td>0.18</td>
<td>0.69</td>
<td>0.52</td>
<td>0.56</td>
<td>0.71</td>
<td>0.56</td>
<td>0.17</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Use PCA to Visualize Customer Segments">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use PCA to Visualize Customer Segments
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-pca-visual" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>X_pca <span class="op">=</span> pca.fit_transform(X_scaled)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>drivers[<span class="st">'pca1'</span>] <span class="op">=</span> X_pca[:, <span class="dv">0</span>]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>drivers[<span class="st">'pca2'</span>] <span class="op">=</span> X_pca[:, <span class="dv">1</span>]</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>drivers, x<span class="op">=</span><span class="st">"pca1"</span>, y<span class="op">=</span><span class="st">"pca2"</span>, hue<span class="op">=</span><span class="st">"cluster"</span>, palette<span class="op">=</span><span class="st">"Set2"</span>, s<span class="op">=</span><span class="dv">70</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"K-Means Clustering of Brand Perceptions"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Principal Component 1"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Principal Component 2"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="pca-visual" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="hw4_questions_files/figure-html/pca-visual-output-1.png" width="757" height="468" class="figure-img"></p>
<figcaption>PCA Visualization of K-Means Clusters</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout-summary" title="Summary: Customer Segments from K-Means Clustering">
<p>K-Means clustering revealed three distinct customer segments based on how they perceive brand attributes:</p>
<ul>
<li><p><strong>Cluster 0 ‚Äì The Enthusiasts</strong><br>
These respondents rate all brand dimensions‚Äî<strong>trust, ease, appeal, service, and impact</strong>‚Äîvery highly. They are likely loyal, satisfied users who should be nurtured through loyalty programs or brand ambassador initiatives.</p></li>
<li><p><strong>Cluster 1 ‚Äì The Selective Believers</strong><br>
Moderately positive on select traits (e.g., trust, service), but less impressed with differentiation and innovation. Messaging to this group should emphasize what makes the brand unique and valuable.</p></li>
<li><p><strong>Cluster 2 ‚Äì The Disengaged Skeptics</strong><br>
Low across the board on all brand attributes. These customers either need substantial re-engagement or may be unresponsive to marketing efforts altogether.</p></li>
</ul>
<p>Together, these insights can guide targeted brand strategies and campaign design for different audience mindsets.</p>
</div>
<p>üßÆ Supervised Learning: K-Nearest Neighbors with Penguin Species Classification In this analysis, we‚Äôll use the Palmer Penguins dataset to train a K-Nearest Neighbors (KNN) classifier that predicts a penguin‚Äôs species based on physical characteristics like flipper length, bill depth, and body mass.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Load and Preprocess the Penguin Dataset">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load and Preprocess the Penguin Dataset
</div>
</div>
<div class="callout-body-container callout-body">
<div id="load-knn-data" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and drop missing values</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="op">=</span> pd.read_csv(<span class="st">"palmer_penguins.csv"</span>).dropna()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Select features and target</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span>, <span class="st">"flipper_length_mm"</span>, <span class="st">"body_mass_g"</span>]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> penguins[features]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> penguins[<span class="st">"species"</span>]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into train/test</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Cleaning the Penguin Data">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cleaning the Penguin Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code loads the Palmer Penguins dataset, removes rows with missing values, and selects relevant features for classification. We split the dataset into training and test sets to evaluate model performance on unseen data, ensuring a fair and unbiased estimate.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Train and Predict Using K-Nearest Neighbors">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Train and Predict Using K-Nearest Neighbors
</div>
</div>
<div class="callout-body-container callout-body">
<div id="train-knn" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize model</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>knn.fit(X_train, y_train)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict and evaluate</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> knn.predict(X_test)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Accuracy: 78.00%
              precision    recall  f1-score   support

      Adelie       0.72      0.86      0.78        44
   Chinstrap       0.70      0.35      0.47        20
      Gentoo       0.89      0.92      0.90        36

    accuracy                           0.78       100
   macro avg       0.77      0.71      0.72       100
weighted avg       0.78      0.78      0.76       100
</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="K-Nearest Neighbor">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
K-Nearest Neighbor
</div>
</div>
<div class="callout-body-container callout-body">
<p>We train a K-Nearest Neighbors classifier with <code>k=5</code>, meaning predictions are based on the five closest neighbors in feature space. We then evaluate performance using accuracy and detailed classification metrics to understand how well the model performs on each species.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Visualize the Confusion Matrix">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visualize the Confusion Matrix
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-cmatrix" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, y_pred, labels<span class="op">=</span>knn.classes_)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm, display_labels<span class="op">=</span>knn.classes_)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>disp.plot(cmap<span class="op">=</span><span class="st">"Blues"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix: KNN on Penguin Species"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="cmatrix" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="hw4_questions_files/figure-html/cmatrix-output-1.png" width="575" height="468" class="figure-img"></p>
<figcaption>Confusion Matrix for KNN Classification</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Don't be Confused by the Confusion Matrix!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Don‚Äôt be Confused by the Confusion Matrix!
</div>
</div>
<div class="callout-body-container callout-body">
<p>The confusion matrix provides a visual summary of prediction performance by showing how many observations were correctly or incorrectly classified. It highlights which species were most often confused‚Äîespecially useful for understanding class-level weaknesses.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Project 2D Decision Boundaries with PCA">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Project 2D Decision Boundaries with PCA
</div>
</div>
<div class="callout-body-container callout-body">
<div id="cell-pca-knn" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>X_proj <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>penguins[<span class="st">"pca1"</span>] <span class="op">=</span> X_proj[:, <span class="dv">0</span>]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>penguins[<span class="st">"pca2"</span>] <span class="op">=</span> X_proj[:, <span class="dv">1</span>]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict clusters in full set</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>knn_all <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>knn_all.fit(X_proj, y)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> knn_all.predict(X_proj)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>penguins[<span class="st">"predicted_species"</span>] <span class="op">=</span> labels</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>penguins, x<span class="op">=</span><span class="st">"pca1"</span>, y<span class="op">=</span><span class="st">"pca2"</span>, hue<span class="op">=</span><span class="st">"predicted_species"</span>, palette<span class="op">=</span><span class="st">"Set2"</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"KNN Classification with PCA Projection"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="pca-knn" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="hw4_questions_files/figure-html/pca-knn-output-1.png" width="661" height="468" class="figure-img"></p>
<figcaption>PCA Projection of KNN Classifier</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="PCA 2D Visualization">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PCA 2D Visualization
</div>
</div>
<div class="callout-body-container callout-body">
<p>We use PCA to reduce the feature space to two dimensions for visualization. This allows us to plot the decision boundaries and predicted species clusters in 2D, making it easier to interpret how the KNN algorithm separates the classes.</p>
</div>
</div>
<div class="callout-summary" title="Summary: Penguin Species Classification with KNN">
<p>Our K-Nearest Neighbors (KNN) model achieved an overall <strong>accuracy of 78%</strong> in predicting penguin species based on physical measurements like bill length, flipper length, and body mass.</p>
<p>Key insights:</p>
<ul>
<li><strong>Adelie penguins</strong> were classified well with high recall (0.86), though a few were confused with Gentoo.</li>
<li><strong>Gentoo penguins</strong> had the best precision and recall (F1-score: 0.90), showing that their physical traits are most distinct.</li>
<li><strong>Chinstrap penguins</strong> were the most challenging to classify, with a recall of only 0.35‚Äîoften mistaken for Adelie.</li>
</ul>
<p>The <strong>confusion matrix</strong> confirms this pattern, with most errors occurring between Adelie and Chinstrap species.</p>
<p>Using <strong>PCA for visualization</strong>, we saw Gentoo penguins form a distinct cluster, while Adelie and Chinstrap overlap more‚Äîexplaining the classifier‚Äôs difficulty.</p>
<p>Overall, this analysis shows that <strong>KNN is an effective but interpretable baseline model</strong> for biological classification problems, especially when species have clearly separable physical traits.</p>
</div>
</section>
</section>
<section id="conclusion-what-we-learned-from-the-data" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-what-we-learned-from-the-data">üßæ Conclusion: What We Learned from the Data</h2>
<p>This project explored both <strong>unsupervised</strong> and <strong>supervised</strong> machine learning techniques to derive insight from real-world marketing and scientific datasets.</p>
<section id="k-means-clustering-unsupervised-learning" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering-unsupervised-learning">üìä K-Means Clustering (Unsupervised Learning)</h3>
<p>Using brand perception data, K-Means revealed <strong>three distinct customer segments</strong>:</p>
<ul>
<li><strong>Enthusiasts</strong> who love the brand across all dimensions</li>
<li><strong>Selective Believers</strong> who value trust but want more differentiation</li>
<li><strong>Disengaged Skeptics</strong> with minimal brand attachment</li>
</ul>
<p>These segments offer clear targets for <strong>marketing strategy</strong>, <strong>product messaging</strong>, and <strong>resource allocation</strong>.</p>
</section>
<section id="k-nearest-neighbors-supervised-learning" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors-supervised-learning">üêß K-Nearest Neighbors (Supervised Learning)</h3>
<p>KNN was applied to predict penguin species based on physical traits. The model:</p>
<ul>
<li>Achieved <strong>78% accuracy</strong> on a held-out test set</li>
<li>Performed best on <strong>Gentoo</strong> and <strong>Adelie</strong> species</li>
<li>Struggled with <strong>Chinstrap</strong>, where features overlap with others</li>
</ul>
<p>This demonstrates KNN‚Äôs utility as an <strong>interpretable baseline classifier</strong>‚Äîespecially when decision boundaries are nonlinear but structured.</p>
<hr>
</section>
<section id="final-takeaways" class="level3">
<h3 class="anchored" data-anchor-id="final-takeaways">üí° Final Takeaways</h3>
<blockquote class="blockquote">
<ul>
<li>Unsupervised learning is ideal for discovering <em>hidden patterns</em> when no outcome labels exist.</li>
<li>Supervised learning shines when <em>predictions</em> are needed from labeled data.</li>
<li>Choosing the right tool depends on your goal: explore or predict, segment or classify.</li>
</ul>
</blockquote>
<p>In marketing analytics, both approaches offer value‚Äîwhether it‚Äôs understanding your audience <strong>before launch</strong>, or <strong>optimizing messaging</strong> once you‚Äôve collected results.</p>
<p>:::</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dominicschenone\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>